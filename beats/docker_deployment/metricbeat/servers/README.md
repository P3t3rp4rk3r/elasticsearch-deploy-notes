# Server Metrics
* [Metric Beat Modules List](https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-modules.html)
## Postgresql
* [Docs Links](https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-postgresql.html)

Create DB user and database 
```
CREATE USER elastic WITH PASSWORD 'changeme';
CREATE DATABASE elastic;
GRANT ALL PRIVILEGES ON DATABASE elastic to elastic;
ALTER USER elastic WITH SUPERUSER;
ALTER USER elastic WITH NOCREATEDB;
```
* Some metrics need super user permissions
In order to get `statement` metricset, enable [pg_stat_statements](https://www.postgresql.org/docs/9.5/pgstatstatements.html)

1. Add the following entries to your postgres.conf
```
shared_preload_libraries = 'pg_stat_statements'

# Increase the max size of the query strings Postgres records
track_activity_query_size = 2048

# Track statements generated by stored procedures as well
pg_stat_statements.track = all
```
2. Restart postgresql daemon
```
$ sudo systemctl restart postgresql
```
3. Create pg_stat_statements` extension

As the docs says
> When pg_stat_statements is loaded, it tracks statistics across all databases of the server. To access and manipulate these statistics, the module provides a view, pg_stat_statements, and the utility functions pg_stat_statements_reset and pg_stat_statements. These are not available globally but can be enabled for a specific database with CREATE EXTENSION pg_stat_statements.

You have to create `pg_stat_statements` extension in the database you what get metrics  


## Redis
* [Docs Link](https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-redis.html)

## Nginx
* [Docs Link](https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-nginx.html)
Add below config to get nginx stats
```
location /nginx_status {
        stub_status;
        access_log   off;
        allow 127.0.0.1;        #only allow requests from localhost
        deny all;               #deny all other hosts
}
```

